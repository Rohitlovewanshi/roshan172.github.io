jQuery(document).foundation();$(document).ready(function(){var t={all:"cumulative",long:"long-challenge",short:"cook-off",ltime:"lunch-time"};var e=Drupal.settings["date_versus_rating"];var a=[];var r=[];var n=1500;var o=function(t,e,o,i,s){var l=function(t){var e=t.length;var a=[];var r;for(var n=0;n<e;n++){r={};if(!t[n]["reason"]){r=[Date.UTC(t[n]["getyear"],t[n]["getmonth"],t[n]["getday"]),parseInt(t[n]["rating"])];a.push(r)}else{r={x:Date.UTC(t[n]["getyear"],t[n]["getmonth"],t[n]["getday"]),y:parseInt(t[n]["rating"]),marker:{symbol:"triangle-down"}};a.push(r)}}if(a==[]){a.push([Date.UTC(2008,1,1),0])}return a};var c=l(e);var h;var f;if(s){h={type:"datetime",dateTimeLabelFormats:{day:"%Y",week:"%Y",month:"%Y",year:"%Y"},title:{text:"Year"}};f={gridLineDashStyle:"longdash",title:{text:"Rating"}}}else{h={type:"datetime",dateTimeLabelFormats:{day:"%Y",week:"%Y",month:"%Y",year:"%Y"},title:{text:"Year",margin:15,style:{"font-weight":"bold","font-size":"13px",color:"#4a4a4a"}}};f={gridLineDashStyle:"longdash",title:{text:"Rating",margin:15,style:{"font-weight":"bold","font-size":"13px",color:"#4a4a4a"}},plotBands:[{color:"#DADADA",from:0,to:1400},{color:"#C9E0CA",from:1400,to:1600},{color:"#CEDAF3",from:1600,to:1800},{color:"#DBD2DE",from:1800,to:2e3},{color:"#FFF0C2",from:2e3,to:2200},{color:"#FFE3C8",from:2200,to:2500},{color:"#F1C1C8",from:2500,to:5e4}]}}var d=function(t){var e=t.series[0].points.length-1;if(t.series[0].points[e]){t.series[0].points[e].select()}};var g=function(t){if(t.series[0].data.length<1){$(t.renderTo).siblings().remove();$(t.renderTo).html('<img src="/sites/all/themes/abessive/images/no-participation-graph.jpg" alt="No Participation">')}};var p=function(t,e){t.update({marker:{fillColor:e,states:{hover:{fillColor:e,lineColor:e}}}})};var m=function(t,e,a){var r=e[t].penalised_in;$.each(r,function(t,r){$.each(e,function(t,e){if(e.code==r){var n=a.series.data[t];p(n,"red")}})})};var u=function(t,e){$.each(t,function(t,a){var r=e.series.data[t];p(r,"#000")})};var v=Highcharts.chart(t,{credits:{enabled:false},chart:{polar:true,type:"line",zoomType:"xy"},plotOptions:{line:{lineWidth:1,color:"#000"},series:{pointStart:e.length>0?e[0].getyear:2008,allowPointSelect:true,cursor:"pointer",marker:{enabled:true,states:{select:{enabled:true}}},states:{hover:{enabled:true,lineWidth:1}},point:{events:{click:function(){var t=this;var a=this.index;var r=0;if(e.length>0){$("#"+o+" .rank-stats .rating").html(this.y+' (<span class="rating-difference"></span>)');$("#"+o+" .rank-stats .global-rank").text(e[a].rank);$("#"+o+" .rank-stats .contest-name").html('<a href="http://www.codechef.com/'+e[a].code+'">'+e[a].name+'</a><span class="time"></span>');$("#"+o+" .rank-stats .contest-name .time").text("("+e[a].end_date+")");$("#"+o+" .rank-stats .participation").text(Drupal.settings.participation[e[a].id]);if(e[a].reason){m(a,e,t);$("#"+o+" .rank-stats .cheated-contest").text(e[a].reason).parent().show()}else{u(e,t);$("#"+o+" .rank-stats .cheated-contest").parent().hide()}if(a==0){r=e[a].rating-n;$("#"+o+" .rank-stats .rating-difference").text((r<0?"":"+")+r)}else{r=e[a].rating-e[a-1].rating;$("#"+o+" .rank-stats .rating-difference").text((r<0?"":"+")+r)}if(!s){$("#"+o+" .rank-stats .left:first-child").css("background-color",e[a].color)}}}}}}},title:{text:null},tooltip:{enabled:false},xAxis:h,yAxis:f,series:[{name:"Rating",data:c,lineWidth:1}]},function(t){d(t);g(t)});if(i=="school"){r.push(v)}else{a.push(v)}};$.each(t,function(t,a){o(a+"-graph",e[t],a,t,false);if(e["all_school"].length>0){o(a+"-graph-school",e[t+"_school"],a+"-school",t+"_school",true)}})});